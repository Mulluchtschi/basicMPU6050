
#include <Wire.h>
#include <basicMPU6050.h> 

#define MPU_ADDRESS_LOW  0x68                
#define MPU_ADDRESS_HIGH 0x69

basicMPU6050<MPU_ADDRESS_LOW> imu1;
basicMPU6050<MPU_ADDRESS_HIGH> imu2;


void setup() {

  Wire.begin();
  Serial.begin(38400);

  Wire.beginTransmission(MPU_ADDRESS_LOW);
  Wire.write(0x6B); // PWR_MGMT_1 register
  Wire.write(0x00); // set to zero (wake up MPU6050)
  Wire.endTransmission();

  Wire.beginTransmission(MPU_ADDRESS_HIGH);
  Wire.write(0x6B); // PWR_MGMT_1 register
  Wire.write(0x00); // set to zero (wake up MPU6050)
  Wire.endTransmission();
 
  Wire.beginTransmission(MPU_ADDRESS_LOW);
  if (Wire.endTransmission() == 0) {
    Serial.println("MPU6050 IMU 1 connected.");
  } else {
    Serial.println("MPU6050 IMU 1 NOT connected!");
  }

  Wire.beginTransmission(MPU_ADDRESS_HIGH);
  if (Wire.endTransmission() == 0) {
    Serial.println("MPU6050 IMU 2 connected.");
  } else {
    Serial.println("MPU6050 IMU 2 NOT connected!");
  }

  imu1.setBias();
  imu2.setBias();
}

void loop() { 

  imu1.updateBias(); 

  Serial.print( imu1.ax() );
  Serial.print( " " );
  Serial.print( imu1.ay() );
  Serial.print( " " );
  Serial.print( imu1.az() );
  Serial.print( " " );
  
  imu2.updateBias();
 
  Serial.print( imu2.ax() );
  Serial.print( " " );
  Serial.print( imu2.ay() );
  Serial.print( " " );
  Serial.print( imu2.az() );
  Serial.println();  


  delay(100);
}

